# .github/workflows/ci.yml (TRONG REPO BACKEND)
name: Build & Test Backend (.NET)

# Khi nào cần chạy workflow này
on:
  push:
    branches: [ "main", "develop" ] # Chạy khi push lên main hoặc develop
  pull_request:
    branches: [ "main" ] # Chạy khi tạo Pull Request vào main

jobs:
  # Một job duy nhất tên là "build-backend"
  build-backend:
    name: Build & Test Backend
    # Chạy trên máy ảo Linux (Ubuntu) - giống hệt môi trường WSL của bạn
    runs-on: ubuntu-latest 

    steps:
    # Bước 1: Lấy code từ repo về máy ảo
    - name: Lấy code
      uses: actions/checkout@v4

    # Bước 2: Cài đặt .NET SDK
    - name: Cài đặt .NET
      uses: actions/setup-dotnet@v4
      with:
        # ⚠️ QUAN TRỌNG: Sửa số 8.0.x
        # Khớp với phiên bản .NET bạn đã cài trên WSL
        dotnet-version: 8.0.111 

    # Bước 3: Tải các dependencies (NuGet packages)
    # Nó sẽ tự động tìm file .sln
    - name: Tải dependencies
      run: dotnet restore

    # Bước 4: Build toàn bộ solution
    - name: Build
      run: dotnet build --no-restore

    # Bước 5: Chạy unit test (nếu có)
    - name: Test (nếu có)
      run: dotnet test --no-build --verbosity normal